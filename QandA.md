# Q&A DCC ELAN

| nr | Question | Priority | Deadline | Q Owner |
| --- | --- | --- | --- | --- |
| 1 | Is reading SPSS files necessary? Might loading in the files in other extensions be faster? | Low |  | Marcel |
| 2 | How does CBS store the files? Is it completely necessary for them that they are in SPSS format? | Low |  | Marcel |
| 3 | Is it possible for CBS to save the files in a more accessible format? | Low |  | Marcel |
| 5 | Can the structure of the code be improved? "A_Preprocess_CBS_ELAN_area_gem_codes.Rmd". Currently there are 1200 lines, which is quite large. Is it possible to split the code up to different files, with each file running a separate part? | Medium |  | Marcel |
| 6 | Is it possible to restructure "A_Preprocess_CBS_ELAN_area_gem_codes.Rmd" to Jasper's suggestions? | Medium |  | Marcel, Jasper |
| 9 | What are the optimal steps to take if we are to switch to online repository systems like GitHub for code sharing? | **High** | Workshop dates | Marcel |
| 10 | How do we make sure people get accustomed to GitHub even if they do not have a computer science background? | **High** | Workshop dates | Marcel |
| 13 | While pre-processing height/weight data, there is a discrepancy between the number of results for R and SPSS (Willemijn). Is there possibly a problem with R? | Medium |  | Willemijn, Lisette, Jasper |
| 14 | There is a discrepancy between the results for BMI when it is calculated from height and weight and BMI when it is taken directly from the "BMI"-field for the same patients, what are (possible) explanations for this? | Medium |  | Willemijn, Janet, Lisette |
| 15 | For the ELAN patient (PAT) file, does every patient have one row? Multiple rows per patient seem to appear when patients switch GPs. 0.13% of the duplicate RINPERSOON rows have different birthdates, how is this possible? |  |  | **??** |
| 16 | If patients first attend a non-ELAN practice and then transfer to an ELAN practice, is the relevant medical history (correctly) transferred to ELAN? How much missing data is there in this aspect? |  |  | **??** |
| 17 | Is it possible to add general statistics on the unlinkable population per data upload, to aid in assessing differences within confounding variables and groups? |  |  | **??** |
| 18 | How much do the medication entries in ELAN GP differ from medication entries in Vektis? In theory they should be identical, but a lot of medication entries are missing in ELAN GP, for a large part this happens when the medication is prescribed by a specialist and this is not communicated to the GP His. I'm mainly interested in the medications commonly used for rheumatic diseases and prescribed by the specialists, to be precise the following level-4 ATC codes: A07EA, A07EC, H02AB, L01AA, L01BA, L01XC, L04AA, L04AB, L04AC, L04AD, L04AX, M01CB, M01CC, P01BA  |  |  | Georgy, **??** |
| 19 | What is the validation of ELAN GP deceased coding (ICPC A96, and administrative entry deceased) against CBS deceased information, possibly Margot already explored this |  |  | Margot? |





## Archive with answers 

| nr | Question | Answer | Date | Who gave the answer? | 
| --- | --- | --- | --- | --- |
| 11 | Can we have a central document or forum on standard questions and frequently asked data points like total amount of patients? An FAQ if you will. | That should be **this file** | 20240315 | Marcel | 
| 4 | Can the author's name and version code be added to code files? | On GitHub, that's all solved! | 20240315 | Marcel | 
| 7 | Is it better to keep "A_Preprocess_CBS_ELAN_area_gem_codes.Rmd" all in one file for clarity's sake for people with non-technical backgrounds? | Especially for non-technical people, separation of concerns adds to clarity, as long as the overall structure is clear and comments are adequate. This should be part of the review process. | 20240315 | Marcel | 
| 8 | Should we stick to R overall? Or should we venture out to SPSS, Python, Excel etc. as well? What are the challenges if we were to head this way? | We will not demand people to use what we want them to use. To keep the barriers low, everybody uses their own environment of preference, BUT the review process should be in place, so you can't be the only one to understand what happens. Challenges will arise (e.g. strategy implemented in one, is not yet available in the other language), but that's the price we pay. | 20240315 | Marcel | 
| 12 | If we were to use GitHub, should we stick to one standardised file format on there? Like R, SPSS, Python etc. | See question 8 | 20240315 | Marcel | 
| GD | CBS: How do I deal with the limited storage at CBS? | For storage at CBS we pay 50 euros a month per gigabyte, hence why there is a strict upper limit and why we need to use the storage space optimally. Limit your storage use by zipping your files, deleting them when you no longer have any need for them, or opting for a smaller file size. Smaller files, such as syntaxes, do not have to be deleted. Files that take up 300gb or more are considered large. | | Frank |
| GD | CBS: How do I deal with the limited RAM (memory) at CBS? | When using R or Python in the CBS environment you can delete objects to free up memory space. Alternatively, you can ask CBS to give you access to the "Zwarve Server". To request use of this server, send an email to [CBS](mailto:microdata@cbs.nl). | | Frank |
| GD | CBS: What variable from **HOOGSTEOPLTAB** is most appropriate to get a person's educational level? | **HOOGSTEOPLTAB** is the most complete and most detailed file with regard to educational levels.It covers about 2/3 of the Dutch population. E.G. the composition of HOOGSTEOPLTAB2018TABV2 is as follows: 10.155.755 records based on registrations in (high precision), 816.413 from EBB (questionnaires), and 706.356 based on age imputation in the age category 0-14. i.e., 87% of the records are based on registrations! To get complete coverage, you may need to perform imputations based on the income of the parents (as a proxy for educational level). | | CBS |
| GD | CBS: From 2008 to 2010, the RINPERSOON KEY of the data of the deceased (overlijdensdata) **DO** is a NUMERIC data type. In other files, RINPERSOON is a STRING, meaning they cannot be linked | SPSS: (1) Copy the STRING version of the RINPERSOONSNUMMER (and change the name); (2) Change the type of the copy to numeric; (3) Now you have both a STRING and a NUMERIC version of RINPERSOONS that can be used to couple the data file to other data files. It is **vital** you change the name of the copy of the STRING. If you change the STRING variable without making a copy first, you can no longer convert it back to STRING.  This is because the conversion to numeric deletes the leading zeroes, which can no longer be retrieved when you convert it again to the STRING format. | | Frank |
| GD | CBS: Why are there negative numbers in the **ZVWZORGKOSTENTAB** ? | They were present in the raw data. They could have been corrections from declarations that have been processed a year later by the health insurance company. One way to deal with this is by excluding people with negative numbers. On the whole, there are not many records with negative numbers. However, keep in mind that positive numbers may also include corrections from the health insurance company. | | Frank |
| GD | CBS: When calculating the total ZVW-costs from **ZVWZORGKOSTENTAB**, there are people without any costs. However, we know people pay an annual fee to their general practitioner, so how does this add up? | Perhaps some people have not claimed any health expenses and they also weren't registered at a general practitioner. This may be the case for 1-2% oe people. This is not caused by a policy that rendered the consultancy costs to 0, because that would mean there is still a registration fee and there are still annual fees. | | Frank |
| GD | CBS: When assessing people's healthcare costs and usage as a predictor or cofounder of a certain event/health status, the event itself may be the cause of a fluctuation in costs and/or usage. A myocardial infarction or a pregnancy in 2020 will lead to higher costs in the year 2020. How can we deal with this? | It depends on your research question and subject. Potentially, you could include the health care costs a year or two years before the event. | | Frank |
| GD | CBS: For the files **INPATAB**, **INHATAB**, **VEHTAB**, that report the numerical value of income, wealth, welfare, and debt. What does it mean if we have a negative value for these variables? For example, in INPPERSPRIM or INHPGESTINKH, there are some RINPERSOON or RINPERSOONHKW with a negative value. Does it mean that these people got a loan from the government? Is it safe to assume that these people have 0 or Missing values?	Negative values for personal- or household incomes are indeed possible, self-employed individuals might have a negative income if their company makes a loss in a specific year. There are also other exceptional cases in which income might be negative, so it is indeed possible to find negative values. | Negative values for personal- or household incomes are indeed possible, self-employed individuals might have a negative income if their company makes a loss in a specific year. There are also other exceptional cases in which income might be negative, so it is indeed possible to find negative values. | | Frank |
| GD | CBS: What is the source of **MEDICIJNTAB**? | The metadata refers to the source file "‘risico-vereveningsbestanden van het Zorginstituut". The Functionele Kostengroepen (FKG) are derived from these. They have certain definitions. E.G. Chronisch gebruik (cronical usage) requires the usage of at least 180 days/year, and the files include the DDDs. All MEDICIJNTAB files include all medication dispensed in that respective year, including one-time and short-term uses. The differences in the MEDICIJNTAB files are caused by the different source files that are used to calculate the FKGs. | | Frank and CBS |
| GD | CBS:  In multiple data files, some people have multiple entries. E.G. the number of people in a household may change multiple times in one year. How would you deal with this specific example? | It depends on your research question and subject. There are multiple ways imaginable to deal with this. Three examples are: (1) Settle on one point in time (e.g. December first, 2017); (2) Opt for the entry that lasted the longest, and; (3) Include the fact that a household's composition has changed multiple times in a year as data in your analysis. | | Frank |
| GD | CBS:  Certain data files have multiple observations for the same RINPERSOON. This is true for SPOLISBUS, as someone can have multiple jobs at the same time. What are the job characteristics of this individual? | How you address this depends on your research question and subject. Three possible solutions are to: (1) Opt for the observation that demands more hours from the individual; (2) Opt for the observation for which the individual has the longest contract, or; (3) Include the fact that people can have multiple jobs at a time in your analysis. | | Frank |
| GD | CBS:  The metadata of the variable INHARMLAG (within **INHATAB**) shows that all calculated incomes are compared to 9249 euros. Is this correct? Intuitively, you would say that the poverty threshold increases annually because of inflation | We do, in fact, correct for inflation. Technically, this is done by converting the income to euros of the year 2000, and by comparing that to the poverty threshold of that year. Equivalently, the original income is compared to the poverty threshold corrected for inflation.  | | CBS |
| GD | CBS:  Within **WMO** data, some products have been requested for specific years, whereas others are requested for multiple years | Some products have been in rotation since 1994, and some from 2015 or later. Be alert of the actual products that can be requested in each given year. | | Frank |
| GD | GP: Are there sources for the used codes, such as ICPC, ATC, dosages and LAB Codes? | [ICPC](https://www.nhg.org/themas/artikelen/icpc-online), [ATC](https://www.whocc.no/atc_ddd_index/), [dosage codes](http://documentatie.tetra.nl/bricks_huisarts/_hoofdstuk/naslag/wcia-tabel.html), and [lab codes](https://aut.nhg.org/labcodeviewer/). | | Frank |
| GD | GP: Some data regarding death is missing, especially with HIS Medicon. Deceased patients are absent from snapshots of the data. The date of death may be before the start of the snapshot. | Use the data on mortality from the CBS microdata (DO and DOODSOORZTAB), **not** the data on mortality from ELAN-H data. | | Frank |
| GD | GP: the registration and termination dates are unreliable | NIVEL has not used these dates for the longest time. A solution is to use the data on registration fees in the ACT file. Henk de Jong uses the following registration fees: (1.) Select records from the table ACT. Use "omschrijving", for which you use the strings "%schrijftar%" or "%schrijving%". (The % is a wildcard in SQL.); (2.) Within that selection, select for whom a registration fee has been received on January 1st, April 1st, Juli 1st and October 1st in the column dDatum; (3.) There will be dates that deviate from the dates mentioned above, but they are very rare and negligable (0,000008% of the total); (4.) Assume the person will be registered for the following 3 months, then; (5.) Add up all the days to get an approximation of the number of days registered per patient. A valid registration fee on January 1st equates to 90 days, April 1st to 91 days, July 1st to 92 days and October 1st to 91 days. | | Frank |
| GD | GP: The termination date is prior to the registration date | This occurs about 35000 times, These columns are therefore not very useful. This may concern people that switch from one medicompractice to another (and the termination date from the previous medicompractice is transfered over to the new mediconpractice). | | Frank |
| GD | GP: The "startdate" is after the end of the snapshot. | When only using ELAN-H data, there is not much to do  about this. The number of missings are also different per HIS. ZIP codes are, however, registered in the CBS microdata. You may opt to link the ELAN-H data to CBS-microdata IF things like SES are relevant to your research. | | Frank |
| GD | GP: There are duplicates of medication and episodes files. | Duplicates of measurement values need to be removed before calculating averages. For now, we do delete duplicates that share the same code and date | | Frank |
| GD | GP: From some HIS-files, not all variablegroups are extracted | Unfortunately. We know that, for instance, Promedisco, cannot supply referrals. | | Frank |
| GD | GP: It is hard to get the doctor and practice from the data | Yes, unfortunately, this data is absent. STIZON is currently looking into a way to make this possible | | Frank |
| GD | GP: Some practices have dozens of patients with the same pseudopatnummer, but different birthdates, and differences in gender per patient | These numbers are very small. STIZON has however promised to look into this. The ELAN-datamanager removes the patients with more than one record with differing birth dates and when the data shows the person has two different genders. | | Frank |
| GD | GP: Some practices have an unrealistic high percentage of passersby (very short-term patients) in their patient population | This is possibly caused by tourists near coastal places. However, this is just one possible explanation. The reason for the high number of passersby may be different per practice. | | Frank |



## Practical considerations (CBS)

| Category | Information | Source |
| --- | --- | --- |
| Differing semantics | Some files contain data for only one year, such as INPATAB2019.  Others contain data from multiple years, such as GWBTAB2019. | GD |
| Variable name inconsistencies | An example of this is the way CBS refers to the ICD-10 code, which differs per data file: it may be signified by the variable DO or DOORZTAB. | GD |
| Different frequencies and dates of data collection | For example, some files in earlier years (before 2011) might be collected every half-year period (around June), while in later years, (after 2011) the data is usually collected in the beginning of the year. | GD |
|  Data inconsistencies  | DO and DOORZTAB are both about the same subject, yet there is data included in both that is not included in the other. | GD |
| Different merge keys | For example, INPATAB includes the keys RINPERSOON and RINPERSOONHKW, while INHATAB only includes the key RINPERSOONHKW. If you want to link the latter data file to another data file that does not include RINPERSOONHKW, you need to use the appropriate file to link the RINPERSOONHKW to RINPERSOON. | GD |
| Data collection after death | CBS does not register the income of a person after they pass away. So, if someone passes away in February, their (**total**) income will be calculated up until January. Analyses that do not take this into account would imply that people who die at the start of the year have a relatively low income, which would be an incorrect conclusion. It is important to note that the derived variable created by CBS INHARMLAG does not take this into account. You could resolve this by **not** including the income of the year of death, and using the (average) income of a year prior as a measure for SES. | GD |
| Getting ZIP codes (postal codes) at a point in time | Adressess are listed in the data file GBADRESOBJECTBUS. You can link the file VSLPOSTCODEBUS to this file by the RINOBJECT-number. GDADRESOBJECTBUS includes the starting and ending date of a person's stay at a certain adress. You can link these files to other data files to get the matching ZIP codes. | GD |
| Linking RINPERSOON | **Always** use **both** RINPERSOON and RINPERSOONS to link data files. | GD |

## Reading Big files in R and Python

Author : [Ammar](mailto:m.a.faiq@lumc.nl)

In R and Python, it is sometimes challenging to read files larger than 1 GB in the CBS environment (e.g. error will show “Error: cannot allocate vector of size XXXXX Mb”). This is due to the fact that : 

1.	The CBS VPN server you used during your login will vary depending on how active the researcher logged in and used that particular server (not only the LUMC researcher). The more users they have, the less memory they have. It is unclear how large the file you can load in R or Python.
1.	Python and R don't have automatic memory management that handles “memory spilling” or “lazy allocation”.

Our recommendation to alleviate these issues is to :

1.	Just in case, try to increase the memory limit in R with the function “memory.limit(size=N)” or N > file size in Bytes.  
1.	Separate the files in SPSS into smaller chunks of files. SPSS can handle “memory spilling” in their software. Therefore SPSS can handle larger data files. Then perform analysis in each smaller file
1.	If you use R, you can read the data using “disk.frame” (credit to  C.P.Beyers@hhs.nl). Please check [this link](https://cran.r-project.org/web/packages/disk.frame/readme/README.html#:~:text=why%20create%20it%3F-,%7Bdisk.,to%20be%20processed%20by%20R)
1.	Or you can use read_csv( …., lazy = True) or other “lazy load” function arguments in R and python


